<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <script>

// Initialize canvas
canvasElement = null;
ctx = null;


// Array of YOBAS
YOBAS = [];




// Every 100ms render Yobas
setInterval(function(){

  var π = Math.PI;  // Math.PI alias

  // Clear screen before render
  ctx.clearRect(0, 0, canvasElement.width, canvasElement.height);

  for(var i = 0; i < YOBAS.length; ++i) {
    var y = YOBAS[i];


    // Local vars
    var X0 = y.position - y.radius; // TODO: what if params.position is 0?
    var Y0 = canvasElement.height - 2 * y.radius;
    var R = y.radius;

    var Δφ = 2 * π + y.direction * (y.speed / R);    // Angle increment, Δφ


    // Calculate direction and next position

    // If Yoba at begin or end
    if(y.position + R + y.speed > canvasElement.width ||
       y.position - R - y.speed < 0)
            y.direction = -y.direction;


    var ΔX = y.direction * y.speed;

    var φ = y.angle + Δφ;


    // Rotate and draw
    ctx.save();
    ctx.translate(X0 + ΔX, Y0);

    ctx.translate(R, R);
    ctx.rotate(φ);
    ctx.drawImage(YOBAS[0].src, -R, -R, 2 * R, 2 * R);

    ctx.restore();

    y.angle = φ % (4 * π);
    y.position += ΔX;
  }


}, 60);


function Yoba(params)
{

  var yobaImage = new Image();
  yobaImage.src = "yoba_image.png";

  // Rotate yoba
  YOBAS.push({
          src:        yobaImage,
          position:   params.position,
          radius:     params.radius,
          speed:      params.speed,
          angle:      0,
          direction:  1,
  });
}



function drawYobas()
{
    // Initialize canvas
  canvasElement = document.getElementById("yoba_track");
  ctx = canvasElement.getContext("2d");

  new Yoba({ radius: 50, position: 100, speed: 10 });

  new Yoba({ radius: 50, position: 300, speed: 10 });
}

    </script>

  </head>
  <body onload="drawYobas()">

    <canvas id="yoba_track" width="1000" height="150">Sosnooley</canvas>

  </body>
</html>
